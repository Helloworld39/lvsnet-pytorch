from .create_torch_file import create_4d_torch_file
from .data_loader import data_loader
from .read_ct import read_nii, read_dicom


DATASET_NAME_MSDC = 'msdc'
DATASET_NAME_3D = '3dircadb1'
DATASET_NAME_COMPANY = 'company'

DATASET_PLACE_LOCAL = 'local'
DATASET_PLACE_AUTODL = 'autodl'


def get_index(dataset_name):
    if dataset_name == 'msdc':
        return [1, 50, 116, 159, 200, 250, 297, 346, 383, 420, 456, 492, 537, 576, 619, 675, 734, 786, 835, 875, 918,
                957, 1065, 1125, 1263, 1308, 1352, 1397, 1438, 1524, 1550, 1591, 1625, 1655, 1697, 1735, 1768, 1805,
                1847, 1887, 1926, 1975, 2015, 2055, 2104, 2141, 2185, 2222, 2261, 2308, 2400, 2445, 2499, 2549, 2603,
                2648, 2684, 2722, 2761, 2817, 2864, 2909, 2954, 2990, 3031, 3072, 3226, 3271, 3308, 3354, 3391, 3436,
                3485, 3527, 3576, 3608, 3652, 3689, 3728, 3765, 3818, 3861, 3900, 3955, 4007, 4052, 4133, 4181, 4240,
                4288, 4343, 4387, 4431, 4484, 4601, 4651, 4697, 4841, 4891, 4941, 4989, 5047, 5105, 5156, 5333, 5385,
                5427, 5481, 5527, 5573, 5612, 5648, 5678, 5759, 5820, 5927, 5981, 6132, 6253, 6358, 6390, 6472, 6508,
                6551, 6583, 6636, 6707, 6738, 6784, 6824, 6878, 6980, 7022, 7056, 7094, 7138, 7198, 7228, 7280, 7310,
                7357, 7404, 7499, 7581, 7686, 7774, 7938, 7990, 8164, 8263, 8315, 8362, 8412, 8576, 8613, 8662, 8761,
                8806, 8847, 8889, 8923, 8968, 9008, 9059, 9111, 9149, 9181, 9226, 9330, 9501, 9536, 9570, 9635, 9659,
                9683, 9814, 9960, 10011, 10138, 10201, 10362, 10413, 10454, 10505, 10556, 10704, 10845, 10892, 11050,
                11181, 11216, 11390, 11473, 11618, 11645, 11675, 11715, 11879, 12043, 12069, 12114, 12257, 12301,
                12469, 12510, 12558, 12702, 12740, 12775, 12896, 13037, 13084, 13129, 13187, 13331, 13482, 13525,
                13562, 13614, 13775, 13895, 13936, 13980, 14029, 14203, 14357, 14466, 14521, 14570, 14612, 14753,
                14802, 14901, 15056, 15192, 15222, 15393, 15449, 15473, 15614, 15661, 15711, 15825, 15865, 15909,
                15998, 16149, 16192, 16297, 16377, 16518, 16696, 16734, 16895, 16945, 17126, 17284, 17345, 17387,
                17538, 17585, 17632, 17687, 17740, 17901, 17935, 18066, 18115, 18145, 18293, 18326, 18470, 18519,
                18657, 18791, 18828, 18980, 19021, 19155, 19202, 19229, 19363, 19397, 19427, 19561, 19609, 19757,
                19791, 19846, 19984, 20036, 20133, 20182, 20230, 20358, 20445, 20613, 20660, 20710, 20760, 20791,
                20838, 20952, 21121]
    elif dataset_name == '3dircadb1':
        return [1, 130, 302, 502, 593, 732, 867, 1018, 1142, 1253, 1375, 1507, 1767, 1889, 2002, 2127, 2282, 2401,
                2475, 2599, 2824]
    elif dataset_name == 'company':
        return [1, 418, 712, 842, 1185, 1475, 1764, 2114, 2364, 2634, 2869, 2996, 3269, 3424, 3641, 4366, 4649, 4948,
                5379, 5875, 6180, 6555, 6780, 6998, 7219, 7448, 7695, 8898, 9274, 9731, 9936, 10252, 10489, 10890,
                11306, 11578, 11903, 12462, 12798, 13019, 13357, 13574, 13881, 13998, 14259, 14566, 14923, 15178,
                15345, 15746, 15991, 16224, 16354, 16579, 17155, 17440, 17770, 18103, 18430, 18611, 18723, 18940,
                19177, 19515, 19725, 20090, 20384, 20710, 21003, 21228, 21453, 21748, 21868, 22205, 22520, 22794,
                23087, 23508, 23620, 23725, 23955, 24195, 24642, 25085, 25558, 25713, 26053, 26327, 26704, 26984,
                27300, 27533, 27838, 27965, 28289]
    else:
        print('dataset name error')
        return []


def dir_manager(dataset_name, where_are_you):
    if where_are_you == 'local':
        dataset_root = 'D:/Github/' + dataset_name
    elif where_are_you == 'autodl':
        dataset_root = '/root/autodl-tmp/' + dataset_name
    else:
        dataset_root = None
    if not dataset_root:
        print('where are you?')
        exit(-1)

    image_root = dataset_root + '/images'
    label_root = dataset_root + '/labels'

    return {
        'root': dataset_root,
        'image': image_root,
        'label': label_root,
    }


def dataset_separate(dataset_name):
    if dataset_name == 'msdc':
        return (0, 101), (101, 103), (298, 303)
    elif dataset_name == '3dircadb1':
        return (0, 14), (14, 15), (15, 20)
    else:
        print('default')
        exit(-1)
